# Tema 5. T√©cnicas para mejorar la estructura y robustez de c√≥digo

## Unidad 1. Gesti√≥n de errores y excepciones

## Ejercicio 5.1.1 (Castellano)

En este ejercicio vamos a trabajar con la generaci√≥n de errores y excepciones, aunque ya los hayamos visto de pasada al trabajar con clases en el caso de las clases abstractas, por ejemplo.

Para ello vamos a realizar un ejercicio partiendo de un inventario que tienes en el c√≥digo de partida del ejercicio.
Este inventario contiene una serie de productos en un array de objetos, cada uno de los cuales representa un producto y tienen la siguiente estructura com√∫n:

```js
{
    code: 156,
    name: 'Black',
    price: 88.99,
    discount: 9,
    amount: 50
},
```

Las caracter√≠sticas de este inventario es que:

- No puede tener productos con el mismo `code`.
- No puede tener productos con el mismo `name`.
- No puede tener productos con un precio inferior a `50`.
- No puede tener descuentos inferiores a `0` o superiores a `10`.
- No puede tener una cantidad negativa.


### A. Clase `IventoryManager`

Se ha de implementar una clase `InventoryManager` que ha de contar con:

- Una propiedad privada `productList` que contendr√° la lista de productos.

- Un m√©todo `init` que recibe como √∫nico par√°metro `products` que contiene la lista de productos inicial.

- Un m√©todo `validateProduct` que recibe como par√°metro un producto y valida que cumpla todos los requisitos indicados anteriormente.

- Un m√©todo `addProduct` que recibe un producto y valide que disponga de todos los datos y cumpla los requisitos anteriores antes de ser a√±adido a la `productList`


Adicionalmente:


### B. M√©todo `init`

Este m√©todo es el encargado de importar (agregando cada uno mediante el m√©todo `addProduct`) los diferentes productos que reciba en el par√°metro `products` a la `productList`.

Adem√°s ha de gestionar los problemas que puedan producirse en ese proceso, de tal forma que al final de toda la importaci√≥n:

- Devuelva `true` si todos los productos se importaron correctamente sin problemas.

- Devuelva una `array` con la lista de los problemas encontrados por cada producto problem√°tico.


### C. M√©todo `nProducts`

Este m√©todo simplemente devolver√° la cantidad de productos contenidos en la `productList`.


### D. M√©todo `validateProduct`

Este m√©todo es el encargado de validar un producto para decidir si se a√±ade o no a la `productList`.

> üí° **NOTA.** Para ello ha de implementar la siguiente funcionalidad (ten en cuenta que puedes dividir la funcionalidad requerida en otros m√©todos privados de la clase para organizar mejor el c√≥digo si lo deseas):

La forma y orden en la que se debe llevar a cabo la validaci√≥n es la siguiente:

- Si alguna de las propiedades est√° vac√≠a o no es del tipo requerido (`code`, `discount` y `amount` un n√∫mero entero no negativo, `name` un **string** no vac√≠o y `price` un n√∫mero positivo flotante con m√°ximo 2 decimales) lanza el siguiente error:

```
ERROR_DATA. Alguno de los datos del producto ([code]) no tiene un formato v√°lido.
```

- Si el c√≥digo del producto a a√±adir ya se encuentra en la lista de productos, lanzar√° el error siguiente:

```
INVENTORY_CODE. Ya existe otro producto con ese c√≥digo ([code]).
```

- Si la lista de productos ya cuenta con un producto que tenga el mismo nombre del producto a a√±adir, lanzar√° el siguiente error:

```
INVENTORY_NAME. El nombre del producto ([code]) ya existe.
```

- Si el producto a a√±adir tiene un precio inferior a 50, lanza el error siguiente:

```
INVENTORY_PRICE. El precio del producto ([code]) no puede ser inferior a 50.
```

- Si el producto a a√±adir tiene un descuento que no se encuentre entre 0 y 10, lanzar√° el siguiente error:

```
INVENTORY_DISCOUNT. El descuento del producto ([code]) debe estar entre 0 y 10.
```

- Si el producto a a√±adir tiene una cantidad negativa, genere el error siguiente:

```
INVENTORY_AMOUNT. La cantidad de producto ([code]) no puede ser inferior a 10.
```

- Si por el contrario, el producto es totalmente v√°lido el m√©todo retorna `true`.



### E. M√©todo `addProduct`

Este m√©todo se encarga de a√±adir un producto al inventario, por lo que recibe como √∫nico par√°metro `product` que es un objeto con la estructura ya comentada, implementando la siguiente funcionalidad:

- Valida el producto mediante el m√©todo `validateProduct`.

- Si es v√°lido, lo a√±ade a la `productList`.

- Si no es v√°lido, recoge el error generado por `validateProduct`.

- Tanto si es v√°lido como si no (uso de `finally`) retorna un objeto con esta estructura:

```js
{
    status: [true | false]
    message: [mensaje_resultado]
}
```

Donde:

- `status`: [true | false]: representa un **booleano** en funci√≥n de si se pudo a√±adir el producto o no.

- `message`: [mensaje_resultado]: es un **string** que en caso de error contiene el error recibido por el m√©todo `validateProduct` y en caso de √©xito contendr√° la cadena `INVENTORY_ADD. El producto ([code]) ha sido a√±adido con √©xito al inventario.`


> üí° NOTA: Ten en cuenta que siempre que veas `[code]` ha de ser sustituido por el valor del c√≥digo del producto en cuesti√≥n.<br>


Por ejemplo, para un producto con c√≥digo `152` algunos mensajes ser√≠an:

```
INVENTORY_NAME. El nombre del producto (152) ya existe.

INVENTORY_AMOUNT. La cantidad de producto (152) no puede ser negativa.

INVENTORY_ADD. El producto (152) ha sido a√±adido con √©xito al inventario.
```


### F. Exportaci√≥n de clase

Exporta la clase `IventoryManager` para poder ser usada en otros m√≥dulos.


-----
